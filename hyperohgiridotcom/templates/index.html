{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
<style>
    .card img {
        height: 166; 
        width: 600px; 
        float: middle;
        max-width: 100%;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    a.pst_d_a
    {
        color: black;
        text-decoration: none;
    }
</style>

<!-- Page header with logo and tagline-->
<header class="py-5 bg-light border-bottom mb-4" style="background-image: url('static/image/SotaWakamatsu_Week14_IndependentResearch_Final_1.png');
background-size: 100%; background-position: 300%;">
    <div class="container">
        <div class="text-center my-5">
            <h1 class="fw-bolder" style="color:white;">ハイパーオーギリドットコム</h1>
            
        </div>
    </div>
</header>
<!-- Page content-->
<img src="static/image/popular_post.png" style="height:30px; width:100px; position:absolute; left: 60px; top:305px; z-index: 9999;"/>
<div class="container">
    <div class="row">
        <!-- Blog entries-->
        <div class="col-lg-8">
            <!-- Featured blog post-->
            {% if most_commented_post %}
                <div class="card mb-4">
                    <!--<a href="#!"><img class="card-img-top" src="https://dummyimage.com/850x350/dee2e6/6c757d.jpg" alt="..." /></a>-->
                    <div class="card-body">
                        <div class="small text-muted">{{ most_commented_post.created_at }}</div>
                        {% if most_commented_post.post_image %}
                            <a href="{% url 'public:post_detail' most_commented_post.id %}" class="pst_d_a"><img src="{{ most_commented_post.post_image.url }}"></a>
                            <hr></hr>
                        {% endif %}
                       
                        <h2 class="card-title"><a href="{% url 'public:post_detail' most_commented_post.id %}" class="pst_d_a">{{ most_commented_post.content }}</a></h2>
                        <p class="card-text"><a href="{% url 'public:user_info'  most_commented_post.user.id %}">{{ most_commented_post.user.username }}</a>さんからのお題</p>
                        <p class="num-comments">回答数：{{ most_commented_post.total_comments}}</p>
                        <a class="btn btn-primary" href="{% url 'public:comment' most_commented_post.id %}">回答する</a>
                        <hr size="0" width="100%" />
                        {% for comment in comments %}
                            <h2>{{ comment.content }}</h2>
                            <p><a href="{% url 'public:user_info' comment.user.id %}">{{comment.user.username}}</a>さんの回答</p>
                            <p class="num-comments">獲得座布団数：{{ comment.num_zabutons }}</p>
                            <a class="btn btn-primary" href="{% url 'public:like_comment' comment.id %}">座布団</a>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
            <!-- Nested row for non-featured blog posts-->
            <div class="row">
                <div class="col-lg-12">
                    {% for post in posts %}
                        <div class="card mb-4">
                            <!--<a href="#!"><img class="card-img-top" src="https://dummyimage.com/850x350/dee2e6/6c757d.jpg" alt="..." /></a>-->
                            <div class="card-body">
                                <div class="small text-muted">{{ post.created_at }}</div>
                                {% if post.post_image %}
                                    <a href="{% url 'public:post_detail' post.id %}" class="pst_d_a"><img src="{{ post.post_image.url }}"></a>
                                    <hr></hr>
                                {% endif %}
                                <h2 class="card-title"><a href="{% url 'public:post_detail' post.id %}" class="pst_d_a">{{ post.content }}</a></h2>
                                <p class="card-text"><a href="{% url 'public:user_info' post.user.id %}">{{ post.user.username }}</a>さんからのお題</p>
                                <p class="num-comments">回答数：{{ post.total_comments }}</p>
                                <a class="btn btn-primary" href="{% url 'public:comment' post.id %}">回答する</a>
                                <hr size="0" width="100%" />
                                {% for comment in post.comments_list %}
                                    <h2>{{ comment.content }}</h2>
                                    <p><a href="{% url 'public:user_info'  comment.user.id %}">{{comment.user.username}}</a>さんの回答</p>
                                    <p class="num-comments">獲得座布団数：{{ comment.num_zabutons }}</p>
                                    <a class="btn btn-primary" href="{% url 'public:like_comment' comment.id %}">座布団</a>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <!-- Side widgets-->
        <div class="col-lg-4">
            <!-- Profile widget-->
            <div class="card mb-4">
                <h1>
                    {{ user.get_full_name }} (@{{user.username}})
                </h1>
                {% with profile=user.profile %}
                {% if profile %}
                    <h2>
                        {{ profile.persona|default:"" }}
                    </h2>
                    <div>
                        {{ profile.bio|default:"" }}
                    </div>
                    <div>
                        {% with website=profile.website|default:"" %}
                            <a href="{{website}}">{{ website }}</a>
                        {% endwith %}
                    </div>
                    <br/>
                    <div>
                        Interests:
                        {% for interest in profile.interests.all %}
                            <span>
                                {{ interest.name }}{% if not forloop.last %}, {% endif %}
                            </span>
                        {% endfor %}
                    </div>
                    <div>
                        総獲得座布団数: {{ profile.total_zabutons_received }}
                        
                    </div>
                {% endif %}
                {% endwith %}
            </div>
           
        </div>
    </div>
</div>
<!-- Footer-->
<footer class="py-5 bg-dark">
    <div class="container"><p class="m-0 text-center text-white">Copyright &copy; Hyperohgiridotcom 2024</p></div>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        {% if alert_over_like_comment_id %}
            alert('既に座布団を付与しています。');
        {% endif %}
    });
    document.addEventListener('DOMContentLoaded', function() {
        {% if alert_over_comment_comment_id %}
            alert('既にお題に回答しています');
        {% endif %}
    });
</script>
{% endblock %}